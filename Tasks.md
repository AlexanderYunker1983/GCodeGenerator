# План доработок GCodeGenerator

## 1. Сверление

### 1.1. Геометрические паттерны (Высокий приоритет)

#### 1.1.1. ✓ ~~Сверление по эллипсу~~
- ~~**Описание**: Сверление отверстий по эллипсу~~
- ~~**Параметры**: центр (X, Y), радиус по X, радиус по Y, количество отверстий, начальный угол, угол поворота~~
- ~~**Применение**: Овальные крепежные отверстия, декоративные элементы~~
- ~~**Зависимости**: Нет~~

#### 1.1.2. Сверление по дуге
- **Описание**: Сверление отверстий по дуге окружности
- **Параметры**: центр, радиус, начальный угол, конечный угол, количество отверстий
- **Применение**: Части окружности, сегменты
- **Зависимости**: Нет

#### 1.1.3. Сверление по многоугольнику (правильному)
- **Описание**: Сверление отверстий по правильному многоугольнику
- **Параметры**: центр, количество сторон, радиус описанной окружности, количество отверстий на сторону, угол поворота
- **Применение**: Шестигранные, восьмигранные крепления
- **Зависимости**: Нет

### 1.2. Режимы сверления (Высокий приоритет)

#### 1.2.1. Реализация стандартных циклов G-кода
- **Описание**: Поддержка различных циклов сверления
- **Режимы**:
  - G81 - Обычное сверление
  - G82 - Сверление с отводом (пауза внизу)
  - G83 - Глубокое сверление (полный отвод)
  - G84 - Нарезание резьбы
  - G85-G89 - Растачивание
- **Зависимости**: Нет

### 1.4. Улучшения существующих операций (Средний приоритет)

#### 1.4.1. Массив с пропусками (шаблон)
- **Описание**: Возможность задавать маску для пропуска отверстий
- **Параметры**: шаблон пропусков (шахматный порядок, пользовательская маска)
- **Применение**: Оптимизация времени обработки
- **Зависимости**: Нет

#### 1.4.2. Массив с переменным шагом
- **Описание**: Массив с изменяющимся шагом между отверстиями
- **Параметры**: начальный шаг, конечный шаг, закон изменения (линейный, экспоненциальный)
- **Применение**: Адаптивные сетки
- **Зависимости**: Нет

#### 1.4.3. Оптимизация порядка сверления
- **Описание**: Алгоритмы оптимизации траектории
- **Алгоритмы**: ближайший сосед, минимальное время перемещения
- **Применение**: Сокращение времени обработки
- **Зависимости**: Нет

### 1.5. Импорт/экспорт (Средний приоритет)

#### 1.5.1. Сверление по координатам из файла
- **Описание**: Импорт координат из внешних файлов
- **Форматы**: CSV, Excel, DXF
- **Применение**: Работа с внешними данными
- **Зависимости**: Библиотеки для работы с файлами

### 1.6. Дополнительные функции (Низкий приоритет)

#### 1.6.1. Сверление по спирали
- **Описание**: Сверление отверстий по спирали Архимеда
- **Параметры**: центр, начальный радиус, конечный радиус, количество витков, шаг, количество отверстий
- **Применение**: Декоративные узоры
- **Зависимости**: Нет

#### 1.6.2. Сверление по треугольной сетке
- **Описание**: Равномерное распределение отверстий по треугольной сетке
- **Параметры**: начальная точка, шаг по X, шаг по Y, количество строк/столбцов, смещение четных рядов
- **Применение**: Теплоотводы, равномерное распределение
- **Зависимости**: Нет

#### 1.6.3. Сверление по зигзагу
- **Описание**: Сверление отверстий по зигзагообразной линии
- **Параметры**: начальная точка, длина сегмента, угол поворота, количество сегментов
- **Применение**: Декоративные узоры
- **Зависимости**: Нет

---

## 2. Фрезерование контуров

### 2.1. ✓ ~~Базовые геометрические формы (Высокий приоритет)~~

#### 2.1.1. ✓ ~~Фрезеровка эллипса~~
- ~~**Описание**: Фрезеровка контура эллипса~~
- ~~**Параметры**: центр (X, Y), радиус по X, радиус по Y, угол поворота~~
- ~~**Применение**: Овальные отверстия, декоративные элементы~~
- ~~**Зависимости**: Нет~~

#### 2.1.2. ✓ ~~Фрезеровка многоугольника (правильного)~~
- ~~**Описание**: Фрезеровка контура правильного многоугольника~~
- ~~**Параметры**: центр, количество сторон, радиус описанной окружности, угол поворота~~
- ~~**Применение**: Шестигранники, восьмигранники~~
- ~~**Зависимости**: Нет~~

#### 2.1.3. ✓ ~~Фрезеровка скругленного прямоугольника~~
- ~~**Описание**: Прямоугольник с закругленными углами~~
- ~~**Параметры**: ширина, высота, радиус скругления углов~~
- ~~**Применение**: Корпуса, панели с закругленными углами~~
- ~~**Зависимости**: Нет~~

### 2.2. Специализированные операции (Высокий приоритет)

#### 2.2.1. Фрезеровка под крепеж (болты/винты)
- **Описание**: Стандартные размеры крепежных отверстий, обрабатываемых фрезой
- **Параметры**: стандартные размеры (M3, M4, M5 и т.д.), тип отверстия (сквозное, глухое, с зенковкой)
- **Применение**: Стандартные крепежные отверстия
- **Зависимости**: Нет

#### 2.2.2. Фрезеровка с зенковкой
- **Описание**: Отверстие с зенковкой для потайных головок, обрабатываемое фрезой
- **Параметры**: диаметр основного отверстия, диаметр зенковки, глубина зенковки
- **Применение**: Потайные головки винтов
- **Зависимости**: Нет

#### 2.2.3. Фрезеровка с рассверловкой
- **Описание**: Пилотное отверстие + финальное отверстие большего диаметра, обрабатываемое фрезой
- **Параметры**: диаметр пилотного отверстия, диаметр финального отверстия, глубина перехода
- **Применение**: Точные отверстия большого диаметра
- **Зависимости**: Нет

### 2.3. Сложные формы (Средний приоритет)

#### 2.3.1. Фрезеровка кольца (тора)
- **Описание**: Контур кольца (внешний и внутренний радиус)
- **Параметры**: центр, внешний радиус, внутренний радиус
- **Применение**: Уплотнительные канавки, декоративные элементы
- **Зависимости**: Нет

#### 2.3.2. Фрезеровка сердцевины (slot)
- **Описание**: Прямоугольный паз
- **Параметры**: центр, длина, ширина, угол поворота
- **Применение**: Пазы, шпоночные канавки
- **Зависимости**: Нет

#### 2.3.3. Фрезеровка контура по точкам (полилиния)
- **Описание**: Произвольный контур из точек с возможностью дуг
- **Параметры**: список точек с возможностью дуг между точками
- **Применение**: Произвольные контуры, импорт из CAD
- **Зависимости**: Нет

### 2.4. ✓ ~~Улучшения архитектуры (Средний приоритет)~~

#### 2.4.1. ✓ ~~Базовый класс для операций контуров~~
- ~~**Описание**: Вынести общую логику в `ProfileOperationBase`~~
- ~~**Преимущества**: Переиспользование кода, единообразие~~
- ~~**Зависимости**: Нет~~

#### 2.4.2. ✓ ~~Единый механизм генерации G-кода~~
- ~~**Описание**: Унификация генерации с поддержкой дуг и аппроксимации~~
- ~~**Зависимости**: 2.4.1~~

### 2.5. Дополнительные функции (Низкий приоритет)

#### 2.5.1. Фрезеровка звезды
- **Описание**: Контур звезды
- **Параметры**: центр, количество лучей, внешний радиус, внутренний радиус, угол поворота
- **Применение**: Декоративные элементы
- **Зависимости**: Нет

#### 2.5.2. Фрезеровка спирали (Архимедова)
- **Описание**: Спиральный контур
- **Параметры**: центр, начальный радиус, конечный радиус, количество витков, шаг
- **Применение**: Декоративные узоры
- **Зависимости**: Нет

#### 2.5.3. Композитные контуры
- **Описание**: Объединение нескольких базовых форм
- **Применение**: Сложные детали из простых элементов
- **Зависимости**: 2.4.1

---

## 3. Фрезерование карманов

### 3.1. Базовые операции (Высокий приоритет)

#### 3.1.1. Карман прямоугольный
- **Описание**: Фрезеровка прямоугольного кармана
- **Параметры**: размеры, глубина, шаг, стратегия обработки
- **Стратегии**: 
  - Зигзаг
  - Спираль от центра
  - Спираль от края
  - Строки/столбцы
- **Зависимости**: Нет

#### 3.1.2. Карман круглый
- **Описание**: Фрезеровка круглого кармана
- **Параметры**: центр, радиус, глубина, шаг, стратегия обработки
- **Стратегии**:
  - Спираль от центра
  - Концентрические окружности
  - Радиальные линии
- **Зависимости**: Нет

#### 3.1.3. Карман эллиптический
- **Описание**: Фрезеровка эллиптического кармана
- **Параметры**: центр, радиусы, глубина, шаг, стратегия
- **Зависимости**: 3.1.1, 3.1.2

### 3.2. Стратегии обработки (Высокий приоритет)

#### 3.2.1. Зигзаг
- **Описание**: Обработка зигзагообразными проходами
- **Параметры**: направление, шаг, угол
- **Зависимости**: 3.1.1

#### 3.2.2. Спираль от центра
- **Описание**: Спиральная обработка от центра к краю
- **Параметры**: шаг, направление
- **Зависимости**: 3.1.1, 3.1.2

#### 3.2.3. Концентрические окружности
- **Описание**: Обработка концентрическими окружностями
- **Параметры**: шаг, направление
- **Зависимости**: 3.1.2

#### 3.2.4. Радиальные линии
- **Описание**: Обработка радиальными линиями от центра
- **Параметры**: количество линий, угол поворота
- **Зависимости**: 3.1.2

### 3.3. Дополнительные функции (Средний приоритет)

#### 3.3.1. Карман с островками
- **Описание**: Карман с необрабатываемыми зонами
- **Параметры**: список островков (прямоугольники, окружности)
- **Зависимости**: 3.1.1, 3.1.2

#### 3.3.2. Карман произвольной формы
- **Описание**: Карман по контуру из точек
- **Параметры**: список точек контура
- **Зависимости**: 2.3.3

#### 3.3.3. Чистовая обработка стенок
- **Описание**: Финальный проход по стенкам кармана
- **Параметры**: допуск, шаг
- **Зависимости**: 3.1.1, 3.1.2

#### 3.3.4. Обработка дна кармана
- **Описание**: Плоская обработка дна кармана
- **Параметры**: шаг, стратегия
- **Зависимости**: 3.1.1, 3.1.2

#### 3.3.5. Черновая и чистовая обработка кармана
- **Описание**: Создание программы черновой и чистовой обработки под один карман
- **Параметры**: 
  - Припуск на чистовую обработку (по стенкам и дну)
  - Параметры черновой обработки (шаг, стратегия)
  - Параметры чистовой обработки (шаг, стратегия)
  - Опция автоматического создания двух операций или одной операции с переключением режимов
- **Применение**: Точная обработка карманов с заданными допусками
- **Зависимости**: 3.1.1, 3.1.2

### 3.4. Оптимизация (Средний приоритет)

#### 3.4.1. Оптимизация траектории
- **Описание**: Минимизация перемещений между проходами
- **Зависимости**: 3.1.1, 3.1.2

#### 3.4.2. Адаптивный шаг
- **Описание**: Автоматический расчет шага на основе материала и инструмента
- **Зависимости**: Нет

---

## 4. 2D-превью

### 4.1. Базовый предпросмотр (Высокий приоритет)

#### 4.1.1. ✓ ~~2D Canvas в главном окне~~
- ~~**Описание**: Отображение всех операций на 2D-плоскости~~
- ~~**Функции**:~~
  - ~~Отображение отверстий (кружки)~~
  - ~~Отображение контуров (прямоугольники, окружности)~~
  - ~~Отображение карманов (заливка)~~
  - ~~Цветовая кодировка по типам операций~~
- ~~**Зависимости**: Нет~~

#### 4.1.2. Интерактивность базового уровня
- **Описание**: Базовые интерактивные функции
- **Функции**:
  - Клик по элементу → открытие формы редактирования
  - Подсветка выбранной операции
  - Информационные подсказки при наведении
- ~~**Зависимости**: 4.1.1~~

#### 4.1.3. Навигация и масштабирование
- **Описание**: Управление отображением
- **Функции**:
  - ~~Масштабирование (колесо мыши, кнопки)~~
  - ~~Панорамирование (перетаскивание)~~
  - Автоматическое масштабирование под все операции
  - ~~Сетка координат~~
  - ~~Оси координат~~
- ~~**Зависимости**: 4.1.1~~

### 4.2. Улучшенный предпросмотр (Средний приоритет)

#### 4.2.1. Легенда и настройки отображения
- **Описание**: Настройка визуализации
- **Функции**:
  - Легенда типов операций
  - Настройки отображения (сетка, оси, размеры)
  - Переключение слоев (сверление, контуры, карманы)
  - Показ/скрытие типов операций
- ~~**Зависимости**: 4.1.1~~

#### 4.2.2. Отображение параметров операций
- **Описание**: Визуализация параметров на схеме
- **Функции**:
  - Размеры контуров
  - Глубины сверления
  - Направления обработки
  - Траектории инструмента
- ~~**Зависимости**: 4.1.1~~

#### 4.2.3. Предпросмотр траектории инструмента
- **Описание**: Отображение пути инструмента
- **Функции**:
  - Быстрые перемещения (G0) - пунктир
  - Рабочие перемещения (G1) - сплошная линия
  - Дуги (G2/G3) - кривые
  - Цветовая кодировка по типам движений
- ~~**Зависимости**: 4.1.1~~

### 4.3. Ограниченное редактирование (Средний приоритет, опционально)

#### 4.3.1. Перемещение элементов
- **Описание**: Drag & drop для изменения позиций
- **Функции**:
  - Перетаскивание отверстий
  - Перетаскивание контуров
  - Привязка к сетке
  - Привязка к другим элементам
- **Зависимости**: ~~4.1.1~~, 4.1.2

#### 4.3.2. Изменение размеров
- **Описание**: Визуальное изменение размеров элементов
- **Функции**:
  - Ручки для изменения размеров
  - Визуальная обратная связь
  - Ограничения (минимальные/максимальные размеры)
- **Зависимости**: 4.3.1

#### 4.3.3. Быстрые операции
- **Описание**: Контекстные операции
- **Функции**:
  - Копирование/вставка
  - Выравнивание элементов
  - Распределение с равными интервалами
  - Удаление элементов
- **Зависимости**: 4.3.1

### 4.4. Дополнительные функции (Низкий приоритет)

#### 4.4.1. Экспорт изображения
- **Описание**: Сохранение схемы в файл
- **Форматы**: PNG, SVG
- ~~**Зависимости**: 4.1.1~~

#### 4.4.2. Печать схемы
- **Описание**: Печать 2D-схемы
- ~~**Зависимости**: 4.1.1~~

#### 4.4.3. Измерения на схеме
- **Описание**: Инструменты измерения
- **Функции**:
  - Измерение расстояний
  - Измерение углов
  - Показ координат курсора
- ~~**Зависимости**: 4.1.1~~

---

## 5. Общие улучшения

### 5.1. Архитектура (Средний приоритет)

#### ✓ ~~5.1.1. Базовые классы для операций~~
- ~~**Описание**: Вынести общую логику в базовые классы~~
- ~~**Классы**:~~
  - ~~`DrillPatternBase` - для паттернов сверления~~
  - ~~`ProfileOperationBase` - для операций контуров~~
  - ~~`PocketOperationBase` - для операций карманов~~
- ~~**Зависимости**: Нет~~

#### 5.1.2. Валидация параметров
- **Описание**: Проверка корректности параметров операций
- **Функции**:
  - Проверка диапазонов значений
  - Проверка логической корректности
  - Предупреждения о потенциальных проблемах
- **Зависимости**: Нет

#### 5.1.3. Шаблоны операций
- **Описание**: Сохранение и загрузка часто используемых конфигураций
- **Зависимости**: Нет

### 5.2. Импорт/экспорт (Средний приоритет)

#### 5.2.1. Импорт из DXF
- **Описание**: Импорт контуров из DXF файлов
- **Зависимости**: Библиотека для работы с DXF

#### 5.2.2. Импорт из SVG
- **Описание**: Импорт контуров из SVG файлов
- **Зависимости**: Библиотека для работы с SVG

#### 5.2.3. Экспорт операций
- **Описание**: Экспорт операций в файл для обмена между проектами
- **Формат**: JSON или XML
- **Зависимости**: Нет

### 5.3. Документация (Низкий приоритет)

#### 5.3.1. Руководство пользователя
- **Описание**: Подробная документация по использованию
- **Зависимости**: Нет

#### 5.3.2. Примеры проектов
- **Описание**: Набор примеров для демонстрации возможностей
- **Зависимости**: Нет

---

## Приоритеты реализации

### Фаза 1 (Высокий приоритет)
1. ✓ ~~Сверление по эллипсу (1.1.1)~~
2. Режимы сверления G81-G89 (1.2.1)
3. ✓ ~~Фрезеровка эллипса (2.1.1)~~
4. ✓ ~~Фрезеровка многоугольника (2.1.2)~~
5. ✓ ~~Фрезеровка скругленного прямоугольника (2.1.3)~~
6. Фрезеровка под крепеж (2.2.1)
7. Фрезеровка с зенковкой (2.2.2)
8. Фрезеровка с рассверловкой (2.2.3)
9. Карман прямоугольный (3.1.1)
10. Карман круглый (3.1.2)
11. Базовый 2D-предпросмотр (~~4.1.1~~, 4.1.2, 4.1.3)

### Фаза 2 (Средний приоритет)
1. Остальные операции сверления (1.1.2, 1.1.3, 1.4.1, 1.4.2, 1.4.3)
2. Сложные формы контуров (2.3.1, 2.3.2, 2.3.3)
3. Стратегии обработки карманов (3.2.1, 3.2.2, 3.2.3, 3.2.4)
4. Черновая и чистовая обработка кармана (3.3.5)
5. Улучшенный предпросмотр (4.2.1, 4.2.2, 4.2.3)
6. ✓ ~~Базовые классы (5.1.1)~~
7. Валидация параметров (5.1.2)

### Фаза 3 (Низкий приоритет, по необходимости)
1. Дополнительные операции сверления (1.6.x)
2. Декоративные формы контуров (2.5.x)
3. Дополнительные функции карманов (3.3.1, 3.3.2, 3.3.3, 3.3.4, 3.4.x)
4. Ограниченное редактирование в 2D (4.3.x)
5. Импорт/экспорт (5.2.x)


