# План доработок GCodeGenerator

## Приоритеты реализации

### Фаза 1 (Высокий приоритет)
1. Настройка системы координат в начале программы (5.3.1) [**v.0.6.1**]
2. ~~Черновая и чистовая обработка кармана (3.1.3) ~~
3. Фрезеровка под крепеж (2.1.1) [**v.0.6.2**]
4. Фрезеровка с зенковкой (2.1.2) [**v.0.6.3**]
5. Фрезеровка с рассверловкой (2.1.3) [**0.6.4**]
6. Ручной и автоматический ремонт контуров из DXF (5.2.1) [**v.0.6.5**]
7. ~~Выход и старт с позиции смены инструмента (для станков без автосмены, в основном что-то а-ля 3018)~~ [**v.0.6.1**]

### Фаза 2 (Средний приоритет)
1. Режимы сверления G81-G89 (1.1.1)
2. Остальные операции сверления (1.2.1, 1.2.2, 1.2.3)
3. Сложные формы контуров (2.2.1)
4. Улучшенный предпросмотр (4.1.1, 4.1.2, 4.1.3)
5. Валидация параметров (5.1.1)
6. Оптимизация траектории карманов (3.2.1, 3.2.2)
7. Оптимизация кода преобразованием координат (5.1.3)

### Фаза 3 (Низкий приоритет, по необходимости)
1. Дополнительные операции сверления (1.4.x)
2. Декоративные формы контуров (2.3.x)
3. Дополнительные функции карманов (3.1.1, 3.1.2, 3.2.x)
4. Ограниченное редактирование в 2D (4.2.x)
5. Импорт/экспорт (5.2.2, 5.2.3)

---

## 1. Сверление

### 1.1. Режимы сверления (Средний приоритет)

#### 1.1.1. Реализация стандартных циклов G-кода
- **Описание**: Поддержка различных циклов сверления
- **Режимы**:
  - G81 - Обычное сверление
  - G82 - Сверление с отводом (пауза внизу)
  - G83 - Глубокое сверление (полный отвод)
  - G84 - Нарезание резьбы
  - G85-G89 - Растачивание
- **Зависимости**: Нет

### 1.2. Улучшения существующих операций (Средний приоритет)

#### 1.2.1. Массив с пропусками (шаблон)
- **Описание**: Возможность задавать маску для пропуска отверстий
- **Параметры**: шаблон пропусков (шахматный порядок, пользовательская маска)
- **Применение**: Оптимизация времени обработки
- **Зависимости**: Нет

#### 1.2.2. Массив с переменным шагом
- **Описание**: Массив с изменяющимся шагом между отверстиями
- **Параметры**: начальный шаг, конечный шаг, закон изменения (линейный, экспоненциальный)
- **Применение**: Адаптивные сетки
- **Зависимости**: Нет

#### 1.2.3. Оптимизация порядка сверления
- **Описание**: Алгоритмы оптимизации траектории
- **Алгоритмы**: ближайший сосед, минимальное время перемещения
- **Применение**: Сокращение времени обработки
- **Зависимости**: Нет

### 1.3. Импорт/экспорт (Средний приоритет)

#### 1.3.1. Сверление по координатам из файла
- **Описание**: Импорт координат из внешних файлов
- **Форматы**: CSV, Excel, DXF
- **Применение**: Работа с внешними данными
- **Зависимости**: Библиотеки для работы с файлами

### 1.4. Дополнительные функции (Низкий приоритет)

#### 1.4.1. Сверление по спирали
- **Описание**: Сверление отверстий по спирали Архимеда
- **Параметры**: центр, начальный радиус, конечный радиус, количество витков, шаг, количество отверстий
- **Применение**: Декоративные узоры
- **Зависимости**: Нет

#### 1.4.2. Сверление по треугольной сетке
- **Описание**: Равномерное распределение отверстий по треугольной сетке
- **Параметры**: начальная точка, шаг по X, шаг по Y, количество строк/столбцов, смещение четных рядов
- **Применение**: Теплоотводы, равномерное распределение
- **Зависимости**: Нет

#### 1.4.3. Сверление по зигзагу
- **Описание**: Сверление отверстий по зигзагообразной линии
- **Параметры**: начальная точка, длина сегмента, угол поворота, количество сегментов
- **Применение**: Декоративные узоры
- **Зависимости**: Нет

---

## 2. Фрезерование контуров

### 2.1. Специализированные операции (Высокий приоритет)

#### 2.1.1. Фрезеровка под крепеж (болты/винты)
- **Описание**: Стандартные размеры крепежных отверстий, обрабатываемых фрезой
- **Параметры**: стандартные размеры (M3, M4, M5 и т.д.), тип отверстия (сквозное, глухое, с зенковкой)
- **Применение**: Стандартные крепежные отверстия
- **Зависимости**: Нет

#### 2.1.2. Фрезеровка с зенковкой
- **Описание**: Отверстие с зенковкой для потайных головок, обрабатываемое фрезой
- **Параметры**: диаметр основного отверстия, диаметр зенковки, глубина зенковки
- **Применение**: Потайные головки винтов
- **Зависимости**: Нет

#### 2.1.3. Фрезеровка с рассверловкой
- **Описание**: Пилотное отверстие + финальное отверстие большего диаметра, обрабатываемое фрезой
- **Параметры**: диаметр пилотного отверстия, диаметр финального отверстия, глубина перехода
- **Применение**: Точные отверстия большого диаметра
- **Зависимости**: Нет

### 2.2. Сложные формы (Средний приоритет)

#### 2.2.1. Фрезеровка сердцевины (slot)
- **Описание**: Прямоугольный паз
- **Параметры**: центр, длина, ширина, угол поворота
- **Применение**: Пазы, шпоночные канавки
- **Зависимости**: Нет

### 2.3. Дополнительные функции (Низкий приоритет)

#### 2.3.1. Фрезеровка звезды
- **Описание**: Контур звезды
- **Параметры**: центр, количество лучей, внешний радиус, внутренний радиус, угол поворота
- **Применение**: Декоративные элементы
- **Зависимости**: Нет

#### 2.3.2. Фрезеровка спирали (Архимедова)
- **Описание**: Спиральный контур
- **Параметры**: центр, начальный радиус, конечный радиус, количество витков, шаг
- **Применение**: Декоративные узоры
- **Зависимости**: Нет

#### 2.3.3. Композитные контуры
- **Описание**: Объединение нескольких базовых форм
- **Применение**: Сложные детали из простых элементов
- **Зависимости**: Нет

---

## 3. Фрезерование карманов

### 3.1. Дополнительные функции (Средний приоритет)

#### 3.1.1. Чистовая обработка стенок
- **Описание**: Финальный проход по стенкам кармана
- **Параметры**: допуск, шаг
- **Зависимости**: Нет

#### 3.1.2. Обработка дна кармана
- **Описание**: Плоская обработка дна кармана
- **Параметры**: шаг, стратегия
- **Зависимости**: Нет

#### 3.1.3. ~~Черновая и чистовая обработка кармана (Высокий приоритет)~~
- ~~**Описание**: Создание программы черновой и чистовой обработки под один карман~~
- ~~**Параметры**: ~~
  - ~~Припуск на чистовую обработку (по стенкам и дну)~~
  - ~~Параметры черновой обработки (шаг, стратегия)~~
  - ~~Параметры чистовой обработки (шаг, стратегия)~~
  - ~~Опция автоматического создания двух операций или одной операции с переключением режимов~~
- ~~**Применение**: Точная обработка карманов с заданными допусками~~
- ~~**Зависимости**: Нет~~

### 3.2. Оптимизация (Средний приоритет)

#### 3.2.1. Оптимизация траектории
- **Описание**: Минимизация перемещений между проходами
- **Зависимости**: Нет

#### 3.2.2. Адаптивный шаг
- **Описание**: Автоматический расчет шага на основе материала и инструмента
- **Зависимости**: Нет

---

## 4. 2D-превью

### 4.1. Улучшенный предпросмотр (Средний приоритет)

#### 4.1.1. Легенда и настройки отображения
- **Описание**: Настройка визуализации
- **Функции**:
  - Легенда типов операций
  - Настройки отображения (сетка, оси, размеры)
  - Переключение слоев (сверление, контуры, карманы)
  - Показ/скрытие типов операций
- **Зависимости**: Нет

#### 4.1.2. Отображение параметров операций
- **Описание**: Визуализация параметров на схеме
- **Функции**:
  - Размеры контуров
  - Глубины сверления
  - Направления обработки
  - Траектории инструмента
- **Зависимости**: Нет

#### 4.1.3. Предпросмотр траектории инструмента
- **Описание**: Отображение пути инструмента
- **Функции**:
  - Быстрые перемещения (G0) - пунктир
  - Рабочие перемещения (G1) - сплошная линия
  - Дуги (G2/G3) - кривые
  - Цветовая кодировка по типам движений
- **Зависимости**: Нет

### 4.2. Ограниченное редактирование (Средний приоритет, опционально)

#### 4.2.1. Перемещение элементов
- **Описание**: Drag & drop для изменения позиций
- **Функции**:
  - Перетаскивание отверстий
  - Перетаскивание контуров
  - Привязка к сетке
  - Привязка к другим элементам
- **Зависимости**: Нет

#### 4.2.2. Изменение размеров
- **Описание**: Визуальное изменение размеров элементов
- **Функции**:
  - Ручки для изменения размеров
  - Визуальная обратная связь
  - Ограничения (минимальные/максимальные размеры)
- **Зависимости**: 4.3.1

#### 4.2.3. Быстрые операции
- **Описание**: Контекстные операции
- **Функции**:
  - Копирование/вставка
  - Выравнивание элементов
  - Распределение с равными интервалами
  - Удаление элементов
- **Зависимости**: 4.3.1

### 4.3. Дополнительные функции (Низкий приоритет)

#### 4.3.1. Экспорт изображения
- **Описание**: Сохранение схемы в файл
- **Форматы**: PNG, SVG
- **Зависимости**: Нет

#### 4.3.2. Печать схемы
- **Описание**: Печать 2D-схемы
- **Зависимости**: Нет

#### 4.3.3. Измерения на схеме
- **Описание**: Инструменты измерения
- **Функции**:
  - Измерение расстояний
  - Измерение углов
  - Показ координат курсора
- **Зависимости**: Нет

---

## 5. Общие улучшения

### 5.1. Архитектура (Средний приоритет)

#### 5.1.1. Валидация параметров
- **Описание**: Проверка корректности параметров операций
- **Функции**:
  - Проверка диапазонов значений
  - Проверка логической корректности
  - Предупреждения о потенциальных проблемах
- **Зависимости**: Нет

#### 5.1.2. Шаблоны операций
- **Описание**: Сохранение и загрузка часто используемых конфигураций
- **Зависимости**: Нет

#### 5.1.3. Оптимизация кода преобразованием координат (Средний приоритет)
- **Описание**: Применение преобразований координат для оптимизации траекторий и повторного использования кода
- **Функции**:
  - Поворот траектории (G68/G69) и сдвиг нулей (G92)
  - Комбинация поворота и сдвига для подгонки под установку детали
  - Масштабирование/отражение (при поддержке станка)
  - Применение преобразований к группам операций
  - Предпросмотр преобразованных траекторий
- **Применение**: Оптимизация под ориентацию заготовки, упрощение переналадки
- **Зависимости**: 5.1.1

### 5.2. Импорт/экспорт

#### 5.2.1. Ручной и автоматический ремонт контуров из DXF (Высокий приоритет)
- **Описание**: Инструменты для исправления проблемных контуров после импорта из DXF
- **Функции**:
  - Автоматическое обнаружение проблем (разрывы, пересечения, дубликаты)
  - Автоматическое исправление типичных проблем
  - Ручное редактирование контуров
  - Соединение разорванных сегментов
  - Удаление дубликатов и пересечений
  - Проверка замкнутости контуров
- **Применение**: Работа с некачественными DXF файлами, подготовка контуров для обработки
- **Зависимости**: Нет

#### 5.2.2. Импорт из SVG (Средний приоритет)
- **Описание**: Импорт контуров из SVG файлов
- **Зависимости**: Библиотека для работы с SVG

#### 5.2.3. Экспорт операций (Средний приоритет)
- **Описание**: Экспорт операций в файл для обмена между проектами
- **Формат**: JSON или XML
- **Зависимости**: Нет

### 5.3. Настройки оборудования (Высокий приоритет)

#### 5.3.1. Настройка системы координат в начале программы (Высокий приоритет)
- **Описание**: Установка системы координат перед выполнением операций
- **Параметры**:
  - Выбор рабочей системы координат (G54-G59)
  - ~~Сдвиг нулей детали (G92) при необходимости~~
  - Безопасное положение для смены инструмента/старта
  - Проверка корректности установки перед запуском операций
- **Применение**: Гарантия корректного базирования перед выполнением программы
- **Зависимости**: Нет

### 5.4. Документация (Низкий приоритет)

#### 5.4.1. Руководство пользователя
- **Описание**: Подробная документация по использованию
- **Зависимости**: Нет

#### 5.4.2. Примеры проектов
- **Описание**: Набор примеров для демонстрации возможностей
- **Зависимости**: Нет

